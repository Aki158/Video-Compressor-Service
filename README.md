# Video-Compressor-Service

## 🌱概要
動画圧縮サービス

## ✨デモ
![output](https://github.com/Aki158/Video-Compressor-Service/assets/119317071/9386459e-1894-46ae-ac95-9c207caafe36)

## 📝説明
このサービスは、動画圧縮サービスです。

サービスの実行には、ターミナルという黒い画面にコマンドを入力します。

このサービスは、動画からオーディオやGIFなど異なるフォーマットを作成したり解像度を変換したい!という場面に使えます。

基本的な機能として、下記のような機能を提供しています。

- 動画ファイルを圧縮する(圧縮度をlow,medium,highの3段階から選択できます)
- 動画の解像度を変更する
- 動画の縦横比を変更する
- 動画をオーディオに変換する
- 指定した時間範囲からGIFを作成する

### 補足
#### 用語集
[説明](#説明)で登場する用語について補足します。

用語の意味がわからない時は、下記表を確認してください。

| 用語 | 意味 |
| ------- | ------- |
| ターミナル | コンピュータに対してテキストベースのコマンド入力と出力を行うインターフェースのことです。<br>このインターフェースは、コマンドラインインターフェース（CLI）とも呼ばれます。<br>[デモ](#デモ)で表示されている黒い画面のことです。 |
| コマンド | コンピュータに対して特定の操作を実行するよう指示するテキストベースの命令です。<br>コマンドを入力することで、コンピュータは、コマンドの意味を読み取りアクションをおこします。 |

## 🧰前提条件
このサービスを実行するには、下記ソフトウェアを事前にインストールしておく必要があります。

インストールされていない場合は、[インストール](#インストール)/[使用方法](#使用方法)/[使用例](#使用例)で記載されているコマンドが実行できませんので

必ずインストールしてから進めてください。

### Git
Gitがインストールされていない場合は、下記手順でインストールしてください。

1. ターミナルを起動する。<br>使用するOSによりターミナルの名称が異なりますので注意してください。<br>(例. Windows:コマンドプロンプト,mac:ターミナル)

2. Gitがインストールされているか確認する。<br>`git version 2.34.1` のように表示された場合は、Gitがインストールされています。<br>以降の手順はスキップしてください。<br>**また、ターミナルは引き続き使用しますので開いたままにしてください!**
```
git --version
```

3. システムを更新する
```
sudo apt-get update
```

4. Gitをインストールする
```
sudo apt install git
```

5. Gitがインストールされたことを確認する。<br>`git version 2.34.1` のように表示されていれば、Gitのインストールは完了です!
```
git --version
```

### Python 3.x
[Python](https://www.python.org/downloads/)の公式サイトからあなたのPCのOSに合わせて、ダウンロードしてください。

ダウンロードしたファイルを使用してインストールできます。

Pythonがインストールされているかは、下記コマンドで確認することができます。

`Python 3.10.12`のように表示されていれば、Pythonはインストールされています。

```
python3 --version
```

### FFmpeg
FFmpegは、ビデオおよびオーディオの変換、エンコード、ストリーミングなどの機能を提供しているライブラリです。

[Download FFmpeg](https://ffmpeg.org/download.html)からダウンロードすることもできます。

下記手順でインストールしてください。

1. FFmpegがインストールされているか確認する。<br>ffmpeg version/configurationなどが表示された場合は、FFmpegがインストールされています。<br>以降の手順はスキップしてください。
```
ffmpeg -version
```

2. システムを更新する
```
sudo apt-get update
```

3. FFmpegをインストールする
```
sudo apt install ffmpeg
```

4. FFmpegがインストールされたことを確認する。<br>ffmpeg version/configurationなどが表示されていれば、FFmpegのインストールは完了です!
```
ffmpeg -version
```

### エンコーダー
Ubuntuを利用している場合は、MP4ファイルが再生できないことがあります。

その場合は、下記記事を参考にしてエンコーダーをインストールしてください。

[Ubuntu 22.04でMP4ファイルが再生できない場合の対処法](https://blog.janjan.net/2022/08/15/ubuntu-play-mp4-movie-file/)

## 🍴インストール
### クローン
このサービスをあなたのPCで実行するために、クローンします。

クローンとは、このサービスの実行に必要なファイル(リポジトリのコンテンツ)をあなたのPCのローカル環境へコピーすることです。

下記手順でクローンしてください。

1. リポジトリをクローンする
```
git clone https://github.com/Aki158/Video-Compressor-Service.git
```

2. クローンしたリポジトリへ移動する
```
cd Video-Compressor-Service
```

## 🚀使用方法
1. inputとoutputフォルダに入っている不要なファイルを削除する
2. インプット用の動画を用意してinputフォルダに格納する
3. 1つ目のターミナル(**サーバ用ターミナル**とする)を起動する
4. サーバ用ターミナルに下記コマンドを入力する
```
python3 server.py
```
5. 2つ目のターミナル(**クライアント用ターミナル**とする)を起動する
6. クライアント用ターミナルに下記コマンドを入力する
```
python3 client.py
```
7. `Type in a file to upload: `と表示されたら、Inputのパスを入力する<br>**推奨 : inputフォルダのファイルパス**
8. 下記指示が表示されたら、利用したい機能を0から4の中から選択して入力する<br>`Please enter a number from 0 to 4`<br>`0 : 動画ファイルを圧縮する`<br>`1 : 動画の解像度を変更する`<br>`2 : 動画の縦横比を変更する`<br>`3 : 動画をオーディオに変換する`<br>`4 : 時間範囲からGIFを作成する`
9. その後、追加で指示が表示されたら、指示に従い入力する
10. サーバ用ターミナルが動き出したら、クライアント用ターミナルに`File generated.`と表示されるまで待つ
11. `Do you want to continue ?`と表示されたら、サービスを続けるか選択する(0 : 終了する/1 : 続ける)
12. outputフォルダにダウンロードされた動画を確認する

## 🙋使用例
一通りの手順のイメージは[デモ](#デモ)を参考にしてください。

1. inputとoutputフォルダに入っている不要なファイルを削除する。<br>クローンしてきた状態だと、サンプルファイルが残っています。<br>今回は、inputフォルダ内のファイルは、以降の手順で使用するのでそのままにして、outputフォルダのファイルをすべて削除しました。
2. インプット用の動画を用意してinputフォルダに格納する。<br>今回は、既にinputフォルダに入っているサンプルファイルを使用するので格納はしません。
3. 1つ目のターミナル(**サーバ用ターミナル**とする)を起動する
4. サーバ用ターミナルに下記コマンドを入力する
```
python3 server.py
```
5. 2つ目のターミナル(**クライアント用ターミナル**とする)を起動する
6. クライアント用ターミナルに下記コマンドを入力する
```
python3 client.py
```
7. `Type in a file to upload: `と表示されたら、Inputのパスを入力する<br>**推奨 : inputフォルダのファイルパス**<br>inputフォルダに入っているinput.mp4を使用したいので、`input/input.mp4`と入力します。
8. 下記指示が表示されたら、利用したい機能を0から4の中から選択して入力する<br>`Please enter a number from 0 to 4`<br>`0 : 動画ファイルを圧縮する`<br>`1 : 動画の解像度を変更する`<br>`2 : 動画の縦横比を変更する`<br>`3 : 動画をオーディオに変換する`<br>`4 : 時間範囲からGIFを作成する`<br>動画をオーディオに変換したいので`3`を入力します。
9. その後、追加で指示が表示されたら、指示に従い入力する。<br>手順8.で`3`を入力した場合、追加の指示がなかったので、スキップします。
10. サーバ用ターミナルが動き出したら、クライアント用ターミナルに`File generated.`と表示されるまで待つ。
11. `Do you want to continue ?`と表示されたら、サービスを続けるか選択する(0 : 終了する/1 : 続ける)。<br>終了したいので、`0`を入力します。
12. outputフォルダにダウンロードされた動画を確認する。<br>outputフォルダに`output_audio.mp3`というファイルが入っていることを確認できました。

## 💾使用技術
<table>
<tr>
  <th>カテゴリ</th>
  <th>技術スタック</th>
</tr>
<tr>
  <td>開発言語</td>
  <td>Python</td>
</tr>
<tr>
  <td rowspan=2>インフラ</td>
  <td>Ubuntu</td>
</tr>
<tr>
  <td>VirtualBox</td>
</tr>
<tr>
  <td rowspan=3>その他</td>
  <td>Git</td>
</tr>
<tr>
  <td>Github</td>
</tr>
<tr>
  <td>FFmpeg</td>
</tr>
</table>

## 👀機能一覧
![image](https://github.com/Aki158/Video-Compressor-Service/assets/119317071/ca894d69-d9ca-46b7-af07-d10cbfa51e65)

| 機能 | 内容 |
| ------- | ------- |
| メッセージの表示 | サービスの進行に必要なメッセージを表示します。 |
| サーバへのファイルアップロード | ユーザーが入力したパスを読み取ります。<br>ファイルが問題なければ、サーバへファイルをアップロードします。<br>下記のような場合には、ファイルのアップロードが出来ずメッセージを表示します。<br>・ファイルサイズが4GBを超える場合:`File must be below 4GB.`<br>・ファイルの拡張子がmp4でない場合:`File extension must be mp4.` |
| サービスに必要な入力の要求 | サービスを利用する際は、いくつかの指示が表示されます。<br>利用するサービスによって指示は異なります。<br>サービスに必要な入力が完了すると、そのデータをサーバへ送信します。 |
| サービスの実行 | サーバは、クライアントからサービスに必要なデータを受信すると、サービスを実行します。<br>サービスは、FFmpegライブラリと実行に必要なデータを利用して実現させています。<br>サービスの実行が完了するとoutputフォルダに動画がダウンロードされます。<br>その後、サーバは、サービスの完了メッセージをクライアントへ送信します。 |
| サービスを続けるかの確認 | サービスを続けるか確認します。<br>続ける場合は、アップロードされたファイルをそのまま使用し、サービスに必要な入力の要求を行います。 |
| サーバへアップロードしたファイルの削除 | サービスを続けるかの確認で終了するを選択した場合、クライアントは、終了通知をサーバへ送信します。<br>サーバは、終了通知を受け取るとアップロードファイルされていたファイルを削除します。 |

## 📜作成の経緯
⭐️後で記載する!!!

作成した理由を記載する。

## ⭐️こだわった点
⭐️後で記載する!!!

テキストや参考にした記事などを再度読み返して技術の理解を深めてから書く。

ここがエンジニアに一番読んでもらいたい箇所なのでできるだけ詳細に書く。

----
【使えるかもしれない素材】

このサービスは動画を圧縮し、異なるフォーマットや解像度に変換することができるクライアントサーバ分散アプリケーションになります。

クライアントのホストシステムの代わりにサーバのリソースを使用することで、ユーザーはすべてのサービスを利用することができます。

TCP通信を用いてクライアント、サーバ間でデータの送受信を行い動画をサーバへアップロードしたり、

選択したサービスに基づき新しい動画をダウンロードできます。

サーバーサイドではFFMPEGライブラリを使用して、すべてのサービスを実現させています。

----

## 📮今後の実装したいもの
- [ ] デスクトップアプリケーションとして利用できるようにする

## 📑参考文献
### 公式ドキュメント
- [Python](https://docs.python.org/ja/3/)


### 参考にしたサイト
- [Python_Download](https://www.python.org/downloads/)
- [Download FFmpeg](https://ffmpeg.org/download.html)
- [Ubuntu 22.04でMP4ファイルが再生できない場合の対処法](https://blog.janjan.net/2022/08/15/ubuntu-play-mp4-movie-file/)
